<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>çŸ¥ã®å†’é™ºè€…ï¼š5å¹´ç”Ÿãƒ’ãƒ¼ãƒ­ãƒ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'DotGothic16', sans-serif;
            background-color: #111;
            color: white;
            overflow: hidden; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢ */
            touch-action: manipulation; /* ã‚¿ãƒƒãƒ—é…å»¶é˜²æ­¢ */
            -webkit-user-select: none; /* iOSç”¨ãƒ†ã‚­ã‚¹ãƒˆé¸æŠé˜²æ­¢ */
            user-select: none;
            -webkit-touch-callout: none; /* iOSé•·æŠ¼ã—ãƒ¡ãƒ‹ãƒ¥ãƒ¼é˜²æ­¢ */
        }
        
        /* ã‚²ãƒ¼ãƒ ç”»é¢ã®æ : iOSã®dvhå¯¾å¿œã¨ã‚»ãƒ¼ãƒ•ã‚¨ãƒªã‚¢ */
        .game-container {
            max-width: 600px;
            margin: 0 auto;
            height: 100vh; /* Fallback */
            height: 100dvh; /* iOS Safariç”¨ */
            display: flex;
            flex-direction: column;
            background-image: linear-gradient(to bottom, #0f172a, #334155);
            position: relative;
            /* iPhoneä¸‹ã®ãƒãƒ¼å¯¾ç­– */
            padding-bottom: env(safe-area-inset-bottom); 
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾© */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        @keyframes attack {
            0% { transform: scale(1); }
            50% { transform: scale(1.5); text-shadow: 0 0 20px yellow; }
            100% { transform: scale(1); }
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes damageText {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }

        .shake-anim { animation: shake 0.5s; }
        .attack-anim { animation: attack 0.2s; }
        
        /* UIãƒ‘ãƒ¼ãƒ„ */
        .hp-bar-bg { background-color: #374151; height: 16px; border-radius: 8px; overflow: hidden; border: 2px solid #fff; }
        .hp-bar-fill { height: 100%; transition: width 0.3s ease-out; }
        .timer-bar { height: 6px; background: linear-gradient(90deg, #22c55e, #eab308, #ef4444); transition: width 0.1s linear; }

        .btn-answer {
            background: linear-gradient(to bottom, #3b82f6, #1d4ed8);
            border: 4px solid #1e3a8a;
            border-radius: 12px;
            box-shadow: 0 6px 0 #1e3a8a;
            transition: all 0.1s;
            -webkit-tap-highlight-color: transparent; /* ã‚¿ãƒƒãƒ—æ™‚ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆå‰Šé™¤ */
        }
        .btn-answer:active:not(:disabled) {
            transform: translateY(6px);
            box-shadow: 0 0 0 #1e3a8a;
        }
        .btn-wrong {
            background: linear-gradient(to bottom, #ef4444, #b91c1c) !important;
            border-color: #7f1d1d !important;
            box-shadow: 0 6px 0 #7f1d1d !important;
        }
        .btn-correct {
            background: linear-gradient(to bottom, #22c55e, #15803d) !important;
            border-color: #14532d !important;
            box-shadow: 0 6px 0 #14532d !important;
        }

        /* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ */
        .character-sprite { font-size: 5rem; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5)); transition: transform 0.3s; }
        .boss-sprite { font-size: 8rem; filter: drop-shadow(0 0 15px rgba(255, 0, 0, 0.7)); }

        /* ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
        #damage-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: red; opacity: 0; pointer-events: none; z-index: 50; transition: opacity 0.1s;
        }
        #flash-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: white; opacity: 0; pointer-events: none; z-index: 50; transition: opacity 0.1s;
        }

        .damage-number {
            position: absolute; font-size: 2rem; font-weight: bold; color: #ff0000;
            text-shadow: 2px 2px 0 #000; animation: damageText 0.8s forwards; z-index: 40;
        }
    </style>
</head>
<body>

<div class="game-container">
    <div id="damage-overlay"></div>
    <div id="flash-overlay"></div>

    <div id="start-screen" class="absolute inset-0 z-30 flex flex-col items-center justify-center bg-gray-900 bg-opacity-95 p-6 text-center">
        <h1 class="text-4xl md:text-6xl text-yellow-400 mb-2 drop-shadow-md">çŸ¥ã®å†’é™ºè€…</h1>
        <h2 class="text-xl md:text-2xl text-white mb-6">ã€œ5å¹´ç”Ÿãƒ’ãƒ¼ãƒ­ãƒ¼ã€œ</h2>
        
        <div class="bg-gray-800 p-4 rounded-lg border-2 border-gray-600 mb-6 w-full text-left text-sm leading-relaxed text-gray-200">
            <p class="mb-2 text-yellow-300 font-bold">ã€MISSIONã€‘</p>
            <p>é­”ç‹ã€Œãƒ ãƒãƒ»ãƒ ãƒã€ãŒä¸–ç•Œä¸­ã®çŸ¥è­˜ã‚’å¥ªã£ãŸï¼</p>
            <p>ã‚¯ã‚¤ã‚ºã«æ­£è§£ã—ã¦ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’å€’ã—ã€<span class="text-yellow-400 font-bold">å…¨10ã‚¹ãƒ†ãƒ¼ã‚¸</span>ã‚’ã‚¯ãƒªã‚¢ã—ã¦ä¸–ç•Œã‚’æ•‘ãˆï¼</p>
        </div>

        <div class="text-6xl mb-6 animate-bounce">ğŸ¦¸â€â™‚ï¸</div>
        
        <button onclick="startGame()" class="bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-4 px-10 rounded-xl text-2xl border-b-8 border-yellow-700 active:border-b-0 active:translate-y-2 transition-all w-full max-w-xs shadow-lg">
            å‡ºå‹•ã™ã‚‹ï¼
        </button>
        <div class="mt-4 text-sm text-gray-400">éŸ³ãŒå‡ºã¾ã™ ğŸ”Š</div>
        <div class="text-sm text-gray-400">æœ€é«˜åˆ°é”ãƒ¬ãƒ™ãƒ«: <span id="high-score-level">1</span></div>
    </div>

    <div id="result-screen" class="hidden absolute inset-0 z-30 flex flex-col items-center justify-center bg-gray-900 bg-opacity-95 p-6 text-center">
        <h1 id="result-title" class="text-5xl text-red-500 mb-4 font-bold">GAME OVER</h1>
        <div class="text-6xl mb-4">ğŸ’€</div>
        <p class="text-xl text-white mb-2">åŠ›å°½ãã¦ã—ã¾ã£ãŸ...</p>
        <div class="bg-gray-800 p-4 rounded-lg border-2 border-gray-600 mb-8 w-full max-w-xs">
            <div class="flex justify-between mb-1"><span>åˆ°é”ãƒ¬ãƒ™ãƒ«:</span> <span id="result-level" class="text-yellow-400 font-bold">1</span></div>
            <div class="flex justify-between mb-1"><span>å€’ã—ãŸæ•µ:</span> <span id="result-score" class="text-yellow-400 font-bold">0</span></div>
            <div class="flex justify-between"><span>æœ€å¤§ã‚³ãƒ³ãƒœ:</span> <span id="result-combo" class="text-yellow-400 font-bold">0</span></div>
        </div>
        <button onclick="location.reload()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-xl text-xl border-b-4 border-blue-700 active:border-b-0 active:translate-y-1 transition-all">
            ã‚‚ã†ä¸€åº¦æŒ‘ã‚€ï¼
        </button>
    </div>

    <div id="ending-screen" class="hidden absolute inset-0 z-40 flex flex-col items-center justify-center bg-gradient-to-b from-blue-900 to-black p-6 text-center">
        <h1 class="text-4xl md:text-5xl text-yellow-300 mb-4 font-bold drop-shadow-[0_0_10px_rgba(255,255,0,0.8)] animate-pulse">MISSION COMPLETE!</h1>
        <div class="text-8xl mb-6 relative">
            ğŸ¦¸â€â™‚ï¸
            <div class="absolute top-0 right-0 text-4xl animate-bounce">ğŸ‘‘</div>
        </div>
        <div class="bg-white bg-opacity-10 p-6 rounded-xl border border-yellow-400 mb-8 w-full backdrop-blur-sm">
            <p class="text-lg text-white mb-4">ãŠã‚ã§ã¨ã†ï¼<br>é­”ç‹ã‚’å€’ã—ã€ä¸–ç•Œã«çŸ¥è­˜ãŒæˆ»ã£ãŸï¼</p>
            <p class="text-sm text-gray-300">å›ã“ããŒçœŸã®ã€ŒçŸ¥ã®ãƒ’ãƒ¼ãƒ­ãƒ¼ã€ã ï¼</p>
        </div>
        
        <div class="text-yellow-400 text-2xl font-bold mb-8">
            FINAL SCORE: <span id="final-score">0</span>
        </div>

        <button onclick="location.reload()" class="bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-4 px-12 rounded-xl text-xl border-b-8 border-yellow-700 active:border-b-0 active:translate-y-2 transition-all">
            ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹
        </button>
    </div>

    <div class="p-3 bg-gray-800 border-b-4 border-gray-700 flex justify-between items-center z-10 shrink-0">
        <div class="flex flex-col w-1/3">
            <div class="text-xs text-gray-400">HERO HP</div>
            <div class="hp-bar-bg relative w-full">
                <div id="player-hp" class="hp-bar-fill bg-green-500 w-full"></div>
            </div>
            <div class="text-xs text-right"><span id="hp-text">100</span>/100</div>
        </div>
        <div class="flex flex-col items-center w-1/3">
            <div class="text-yellow-400 font-bold text-xl drop-shadow-md">Lv.<span id="level-display">1</span></div>
            <div class="text-xs text-gray-400">STAGE <span id="stage-display">1</span></div>
        </div>
        <div class="flex flex-col w-1/3 items-end">
            <div class="text-xs text-gray-400">ENEMY HP</div>
            <div class="hp-bar-bg relative w-full">
                <div id="enemy-hp" class="hp-bar-fill bg-red-500 w-full"></div>
            </div>
        </div>
    </div>

    <div class="flex-grow relative flex flex-col justify-center items-center overflow-hidden bg-gray-900">
        <div class="absolute inset-0 opacity-20" style="background-image: radial-gradient(#4b5563 1px, transparent 1px); background-size: 20px 20px;"></div>

        <div id="enemy-container" class="flex flex-col items-center mb-10 transition-all duration-300">
            <div id="enemy-sprite" class="character-sprite">ğŸ‘¾</div>
            <div id="enemy-name" class="mt-2 text-red-300 font-bold bg-black bg-opacity-50 px-2 rounded">ã‚¹ãƒ©ã‚¤ãƒ </div>
        </div>
        
        <div id="combo-display" class="hidden absolute top-4 right-4 text-right">
            <div class="text-yellow-400 font-bold text-3xl italic animate-pulse"><span id="combo-count">2</span> COMBO!</div>
            <div class="text-sm text-white">SCORE UP!</div>
        </div>

        <div class="absolute bottom-4 left-6 text-5xl opacity-80 filter drop-shadow-lg">ğŸ¦¸â€â™‚ï¸</div>
    </div>

    <div class="bg-gray-800 border-t-4 border-gray-700 p-4 z-20 pb-8 rounded-t-3xl shadow-lg -mt-6 shrink-0 safe-area-pb">
        <div class="w-full bg-gray-700 h-2 mb-3 rounded-full overflow-hidden">
            <div id="timer-bar" class="timer-bar w-full"></div>
        </div>

        <div class="mb-4 min-h-[4rem]">
            <span id="q-category" class="inline-block bg-blue-600 text-xs px-2 py-1 rounded text-white mb-1">ç®—æ•°</span>
            <p id="q-text" class="text-lg font-bold leading-relaxed">ã“ã“ã«å•é¡ŒãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
        </div>

        <div id="options-container" class="grid grid-cols-1 gap-3">
            <button class="btn-answer w-full py-3 px-4 text-lg font-bold text-white relative overflow-hidden">
                é¸æŠè‚¢A
            </button>
            <button class="btn-answer w-full py-3 px-4 text-lg font-bold text-white relative overflow-hidden">
                é¸æŠè‚¢B
            </button>
            <button class="btn-answer w-full py-3 px-4 text-lg font-bold text-white relative overflow-hidden">
                é¸æŠè‚¢C
            </button>
        </div>
    </div>
</div>

<script>
// ========== éŸ³å£°è¨­å®š ==========
const bgm = new Audio('audio/quiz.mp3'); // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
bgm.loop = true; // ãƒ«ãƒ¼ãƒ—å†ç”Ÿ
bgm.volume = 0.4; // éŸ³é‡èª¿æ•´

// ========== ãƒ‡ãƒ¼ã‚¿ (å…ƒã®ã‚³ãƒ¼ãƒ‰ã¨åŒã˜) ==========
const QUIZ_DB = [
    // --- ç®—æ•° (Math) ---
    { cat: "ç®—æ•°", q: "3.14 Ã— 2 =", a: ["6.28", "6.14", "3.28"], c: 0 },
    { cat: "ç®—æ•°", q: "ä¸‰è§’å½¢ã®é¢ç©ã®å…¬å¼", a: ["åº•è¾ºÃ—é«˜ã•Ã·2", "åº•è¾ºÃ—é«˜ã•", "åŠå¾„Ã—åŠå¾„Ã—3.14"], c: 0 },
    { cat: "ç®—æ•°", q: "1000ã®1/10ã¯ï¼Ÿ", a: ["100", "10", "0.1"], c: 0 },
    { cat: "ç®—æ•°", q: "180åº¦ã®è§’ã®åå‰", a: ["å¹³è§’", "ç›´è§’", "é‹­è§’"], c: 0 },
    { cat: "ç®—æ•°", q: "åˆ†æ¯ãŒé•ã†è¶³ã—ç®—ã§ã™ã‚‹ã“ã¨ã¯ï¼Ÿ", a: ["é€šåˆ†", "ç´„åˆ†", "å¾®åˆ†"], c: 0 },
    { cat: "ç®—æ•°", q: "ä¸€è¾º5cmã®ç«‹æ–¹ä½“ã®ä½“ç©", a: ["125ã¤", "25ã¤", "15ã¤"], c: 0 },
    { cat: "ç®—æ•°", q: "1ha (ãƒ˜ã‚¯ã‚¿ãƒ¼ãƒ«)ã¯ä½•ã¡ï¼Ÿ", a: ["10000ã¡", "1000ã¡", "100ã¡"], c: 0 },
    { cat: "ç®—æ•°", q: "å¶æ•°ï¼‹å¥‡æ•°ã¯ï¼Ÿ", a: ["å¥‡æ•°", "å¶æ•°", "ã‹ã‚ã‚‰ãªã„"], c: 0 },
    { cat: "ç®—æ•°", q: "ä¸‰è§’å½¢ã®å†…è§’ã®å’Œ", a: ["180åº¦", "360åº¦", "90åº¦"], c: 0 },
    { cat: "ç®—æ•°", q: "äº”è§’å½¢ã®å†…è§’ã®å’Œ", a: ["540åº¦", "360åº¦", "720åº¦"], c: 0 },
    { cat: "ç®—æ•°", q: "ç›´å¾„10cmã®å††å‘¨", a: ["31.4cm", "314cm", "3.14cm"], c: 0 },
    { cat: "ç®—æ•°", q: "3.14 Ã— 100 =", a: ["314", "31.4", "3140"], c: 0 },
    { cat: "ç®—æ•°", q: "å‰²åˆã‚’è¡¨ã™ã€Œï¼…ã€ã®èª­ã¿æ–¹", a: ["ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆ", "ã‚»ãƒ³ãƒ", "ãƒ¡ãƒ¼ãƒˆãƒ«"], c: 0 },
    { cat: "ç®—æ•°", q: "1ã‚ˆã‚Šå°ã•ã„æ•°ã‚’ã‹ã‘ã‚‹ã¨ï¼Ÿ", a: ["å°ã•ããªã‚‹", "å¤§ãããªã‚‹", "å¤‰ã‚ã‚‰ãªã„"], c: 0 },
    { cat: "ç®—æ•°", q: "å››è§’å½¢ã®å†…è§’ã®å’Œ", a: ["360åº¦", "180åº¦", "540åº¦"], c: 0 },
    { cat: "ç®—æ•°", q: "å¹³å‡ã‚’æ±‚ã‚ã‚‹è¨ˆç®—", a: ["åˆè¨ˆÃ·å€‹æ•°", "å€‹æ•°Ã·åˆè¨ˆ", "æœ€å¤§-æœ€å°"], c: 0 },
    { cat: "ç®—æ•°", q: "4ã¨6ã®æœ€å°å…¬å€æ•°", a: ["12", "24", "2"], c: 0 },
    { cat: "ç®—æ•°", q: "8ã¨12ã®æœ€å¤§å…¬ç´„æ•°", a: ["4", "2", "8"], c: 0 },
    { cat: "ç®—æ•°", q: "1mã¯ä½•cmï¼Ÿ", a: ["100cm", "10cm", "1000cm"], c: 0 },
    { cat: "ç®—æ•°", q: "ç›´æ–¹ä½“ã®ä½“ç©å…¬å¼", a: ["ãŸã¦Ã—æ¨ªÃ—é«˜ã•", "ä¸€è¾ºÃ—ä¸€è¾ºÃ—ä¸€è¾º", "åº•è¾ºÃ—é«˜ã•"], c: 0 },
    { cat: "ç®—æ•°", q: "ç«‹æ–¹ä½“ã®ä½“ç©å…¬å¼", a: ["ä¸€è¾ºÃ—ä¸€è¾ºÃ—ä¸€è¾º", "ãŸã¦Ã—æ¨ªÃ—é«˜ã•", "åº•é¢ç©Ã—é«˜ã•"], c: 0 },
    { cat: "ç®—æ•°", q: "2.5 Ã— 4 =", a: ["10", "100", "8.5"], c: 0 },
    { cat: "ç®—æ•°", q: "1/2 ï¼‹ 1/4 ï¼", a: ["3/4", "2/6", "2/4"], c: 0 },
    { cat: "ç®—æ•°", q: "é€Ÿã•ã®å…¬å¼(é“ã®ã‚Š)", a: ["é€Ÿã•Ã—æ™‚é–“", "é€Ÿã•Ã·æ™‚é–“", "æ™‚é–“Ã·é€Ÿã•"], c: 0 },
    { cat: "ç®—æ•°", q: "æ™‚é€Ÿ60kmã§2æ™‚é–“é€²ã‚€ã¨ï¼Ÿ", a: ["120km", "30km", "90km"], c: 0 },
    { cat: "ç®—æ•°", q: "å††å‘¨ç‡ã¯ãŠã‚ˆãã„ãã¤ï¼Ÿ", a: ["3.14", "3.41", "3.11"], c: 0 },
    { cat: "ç®—æ•°", q: "0.1 Ã— 0.1 =", a: ["0.01", "0.1", "1.0"], c: 0 },
    { cat: "ç®—æ•°", q: "åˆåŒãªå›³å½¢ã¨ã¯ï¼Ÿ", a: ["ã´ã£ãŸã‚Šé‡ãªã‚‹", "é¢ç©ãŒåŒã˜", "å½¢ãŒä¼¼ã¦ã„ã‚‹"], c: 0 },
    { cat: "ç®—æ•°", q: "æ¯”ä¾‹ã®ã‚°ãƒ©ãƒ•ã®å½¢ã¯ï¼Ÿ", a: ["ç›´ç·š", "æ›²ç·š", "æŠ˜ã‚Œç·š"], c: 0 },
    { cat: "ç®—æ•°", q: "æ­£å¤šè§’å½¢ã¯ç·šå¯¾ç§°ï¼Ÿ", a: ["ãã†ã§ã‚ã‚‹", "ã¡ãŒã†", "å›³å½¢ã«ã‚ˆã‚‹"], c: 0 },

    // --- å›½èª (Japanese) ---
    { cat: "å›½èª", q: "ã€Œåƒè¼‰ä¸€é‡ã€ã®æ„å‘³", a: ["çµ¶å¥½ã®æ©Ÿä¼š", "å¤§ãƒ”ãƒ³ãƒ", "é•·ã„æ­´å²"], c: 0 },
    { cat: "å›½èª", q: "ã€Œæ˜æ—¥ã€ã®å¯¾ç¾©èª", a: ["æ˜¨æ—¥", "æœªæ¥", "éå»"], c: 0 },
    { cat: "å›½èª", q: "ã€ŒçŒ«ã«å°åˆ¤ã€ã¨åŒã˜æ„å‘³", a: ["é¦¬ã®è€³ã«å¿µä»", "çŠ¬ã‚‚æ­©ã‘ã°", "è™ã®å¨ã‚’å€Ÿã‚‹"], c: 0 },
    { cat: "å›½èª", q: "ã€Œäº”æœˆé›¨ã€ã®èª­ã¿æ–¹", a: ["ã•ã¿ã ã‚Œ", "ã”ãŒã¤ã‚ã‚", "ã•ã¤ãã‚ã‚"], c: 0 },
    { cat: "å›½èª", q: "ã€Œç«¹é¦¬ã®å‹ã€ã®æ„å‘³", a: ["å¹¼ãªã˜ã¿", "ãƒ©ã‚¤ãƒãƒ«", "å…„å¼Ÿ"], c: 0 },
    { cat: "å›½èª", q: "ã€Œç”»ç«œç‚¹ç›ã€ã®èª­ã¿", a: ["ãŒã‚Šã‚‡ã†ã¦ã‚“ã›ã„", "ãŒã‚Šã‚…ã†ã¦ã‚“ã›ã„", "ãŒã‚ã†ã¦ã‚“ã›ã„"], c: 0 },
    { cat: "å›½èª", q: "ã€Œä¸€çŸ³ã€‡é³¥ã€", a: ["äºŒ", "ä¸‰", "ç™¾"], c: 0 },
    { cat: "å›½èª", q: "ã€Œæ°µï¼ˆã•ã‚“ãšã„ï¼‰ã€ã®æ„å‘³", a: ["æ°´", "å¿ƒ", "æ‰‹"], c: 0 },
    { cat: "å›½èª", q: "æ•¬èªã®ç¨®é¡ã§ã¯ãªã„ã‚‚ã®", a: ["æ¨™æº–èª", "å°Šæ•¬èª", "è¬™è­²èª"], c: 0 },
    { cat: "å›½èª", q: "ã€Œã„ã¨ã‚’ã‹ã—ã€ã®æ„å‘³", a: ["ã¨ã¦ã‚‚ãŠã‚‚ã—ã‚ã„", "ã¨ã¦ã‚‚ãŠã„ã—ã„", "ã¨ã¦ã‚‚ãŠã‹ã—ã„"], c: 0 },
    { cat: "å›½èª", q: "ç«¹å–ç‰©èªã®ä¸»äººå…¬", a: ["ã‹ãã‚„å§«", "æ¡ƒå¤ªéƒ", "æµ¦å³¶å¤ªéƒ"], c: 0 },
    { cat: "å›½èª", q: "ã€Œæ ¡æ­£ã€ã®æ„å‘³", a: ["é–“é•ã„ã‚’ç›´ã™", "å­¦æ ¡ã‚’æ­£ã™", "æ§‹æˆã‚’è€ƒãˆã‚‹"], c: 0 },
    { cat: "å›½èª", q: "ã€Œç´…è‘‰ã€ã®èª­ã¿æ–¹", a: ["ã“ã†ã‚ˆã†", "ã‚‚ã¿ã°", "ã¹ã«ã°"], c: 0 },
    { cat: "å›½èª", q: "ã€Œå¤§é»’æŸ±ã€ã®æ„å‘³", a: ["ä¸€å®¶ã‚’æ”¯ãˆã‚‹äºº", "é»’ã„æŸ±", "å¤ªã„æŸ±"], c: 0 },
    { cat: "å›½èª", q: "ã€ŒçŸ›ç›¾ã€ã®ç”±æ¥ã«ãªã£ãŸæ­¦å™¨", a: ["çŸ›ã¨ç›¾", "å‰£ã¨é§", "å¼“ã¨çŸ¢"], c: 0 },
    { cat: "å›½èª", q: "ã€Œè›é›ªã®åŠŸã€ã®æ„å‘³", a: ["è‹¦åŠ´ã—ã¦å‹‰å¼·ã™ã‚‹", "é›ªéŠã³ã‚’ã™ã‚‹", "è›ã‚’æ•ã¾ãˆã‚‹"], c: 0 },
    { cat: "å›½èª", q: "å››å­—ç†Ÿèªã€Œã€‡è‚‰ã€‡é£Ÿã€", a: ["å¼±ãƒ»å¼·", "ç„¼ãƒ»å®š", "å¤§ãƒ»å°"], c: 0 },
    { cat: "å›½èª", q: "ç‰©èªã®ã€Œã‚¯ãƒ©ã‚¤ãƒãƒƒã‚¯ã‚¹ã€", a: ["æœ€é«˜æ½®", "å§‹ã¾ã‚Š", "çµ‚ã‚ã‚Š"], c: 0 },
    { cat: "å›½èª", q: "ã€Œè›‡è¶³ã€ã®æ„å‘³", a: ["ä½™è¨ˆãªã‚‚ã®", "è¶³ã‚Šãªã„ã‚‚ã®", "è¶³ãŒé•·ã„"], c: 0 },
    { cat: "å›½èª", q: "ä¿³å¥ã®æ–‡å­—æ•°ã¯ï¼Ÿ", a: ["5ãƒ»7ãƒ»5", "5ãƒ»7ãƒ»5ãƒ»7ãƒ»7", "7ãƒ»5ãƒ»7"], c: 0 },
    { cat: "å›½èª", q: "ã€Œæ€¥ãŒã°å›ã‚Œã€ã®æ„å‘³", a: ["ç¢ºå®Ÿãªé“ãŒè‰¯ã„", "æ€¥ã„ã æ–¹ãŒè‰¯ã„", "å›ã‚‹ã¨é…ã‚Œã‚‹"], c: 0 },
    { cat: "å›½èª", q: "ã€Œæ¡ˆã®å®šã€ã®æ„å‘³", a: ["äºˆæƒ³é€šã‚Š", "äºˆæƒ³å¤–", "å®‰å¿ƒã—ãŸ"], c: 0 },
    { cat: "å›½èª", q: "ã€Œæœˆã¨ã™ã£ã½ã‚“ã€ã®æ„å‘³", a: ["æ¯”ã¹ç‰©ã«ãªã‚‰ãªã„", "ä¼¼ã¦ã„ã‚‹", "ä»²ãŒè‰¯ã„"], c: 0 },
    { cat: "å›½èª", q: "ã€Œå¤æ± ã‚„è›™é£›ã³è¾¼ã‚€â€¦ã€", a: ["æ°´ã®éŸ³", "æ± ã®éŸ³", "é›¨ã®éŸ³"], c: 0 },
    { cat: "å›½èª", q: "ä¸»èªã¨ã€‡ã€‡èª", a: ["è¿°èª", "è‹±èª", "ç‰©èª"], c: 0 },
    { cat: "å›½èª", q: "ã€Œå°æ˜¥æ—¥å’Œã€ã®å­£ç¯€ã¯ï¼Ÿ", a: ["å†¬ã®åˆã‚", "æ˜¥", "ç§‹"], c: 0 },
    { cat: "å›½èª", q: "ã€Œç„¡æˆ‘å¤¢ä¸­ã€ã®æ„å‘³", a: ["å¿ƒã‚’å¥ªã‚ã‚Œã‚‹", "å¤¢ã‚’è¦‹ã‚‹", "æˆ‘æ…¢ã™ã‚‹"], c: 0 },
    { cat: "å›½èª", q: "ãƒ­ãƒ¼ãƒå­—ã®ã€ŒSHIã€", a: ["ã—", "ã¡", "ã²"], c: 0 },
    { cat: "å›½èª", q: "ã€ŒãŠæ¯ã•ã‚“ã€ãŒã€ç¬‘ã†ã€", a: ["ä¸»èª", "è¿°èª", "ä¿®é£¾èª"], c: 0 },
    { cat: "å›½èª", q: "æœ¬ã‚’æ•°ãˆã‚‹å˜ä½", a: ["å†Š", "æœ¬", "æš"], c: 0 },

    // --- ç†ç§‘ (Science) ---
    { cat: "ç†ç§‘", q: "ãƒ¡ãƒ€ã‚«ã®ã‚ªã‚¹ã¯ï¼Ÿ", a: ["èƒŒã³ã‚Œã«åˆ‡ã‚Œè¾¼ã¿", "è…¹ã³ã‚ŒãŒå¤§ãã„", "è‰²ãŒæ´¾æ‰‹"], c: 0 },
    { cat: "ç†ç§‘", q: "å°é¢¨ã®ã†ãšå·»ãã®å‘ã", a: ["å·¦å·»ã", "å³å·»ã", "æ±ºã¾ã£ã¦ãªã„"], c: 0 },
    { cat: "ç†ç§‘", q: "æ°´ã®æ²¸é¨°ã™ã‚‹æ¸©åº¦", a: ["100åº¦", "90åº¦", "110åº¦"], c: 0 },
    { cat: "ç†ç§‘", q: "ç¨®å­ã®ç™ºèŠ½æ¡ä»¶ã€æ°´ãƒ»ç©ºæ°—ã¨â€¦", a: ["é©å½“ãªæ¸©åº¦", "æ—¥å…‰", "è‚¥æ–™"], c: 0 },
    { cat: "ç†ç§‘", q: "ã‚¤ãƒ³ã‚²ãƒ³ãƒãƒ¡ã®é¤Šåˆ†ã¯ã©ã“ï¼Ÿ", a: ["å­è‘‰", "æ ¹", "è‘‰"], c: 0 },
    { cat: "ç†ç§‘", q: "é£Ÿå¡©ãŒæ°´ã«æº¶ã‘ã‚‹é™åº¦", a: ["æ±ºã¾ã£ã¦ã„ã‚‹", "ç„¡é™", "æ¸©åº¦ã«ã‚ˆã‚‹"], c: 0 },
    { cat: "ç†ç§‘", q: "é›²ã®å‹•ãã¨é–¢ä¿‚ã‚ã‚‹ã®ã¯ï¼Ÿ", a: ["å¤©æ°—ã®å¤‰åŒ–", "åœ°éœ‡", "æ½®ã®æº€ã¡å¼•ã"], c: 0 },
    { cat: "ç†ç§‘", q: "å·ã®å¤–å´ã¯æµã‚ŒãŒï¼Ÿ", a: ["é€Ÿã„", "é…ã„", "åŒã˜"], c: 0 },
    { cat: "ç†ç§‘", q: "ãµã‚Šã“ã®1å¾€å¾©ã®æ™‚é–“", a: ["é•·ã•ã§å¤‰ã‚ã‚‹", "é‡ã•ã§å¤‰ã‚ã‚‹", "æŒ¯ã‚Œå¹…ã§å¤‰ã‚ã‚‹"], c: 0 },
    { cat: "ç†ç§‘", q: "ãƒ’ãƒˆã®èµ¤ã¡ã‚ƒã‚“ãŒè‚²ã¤å ´æ‰€", a: ["å­å®®", "èƒƒ", "å¿ƒè‡“"], c: 0 },
    { cat: "ç†ç§‘", q: "èŠ±ç²‰ãŒã‚ã—ã¹ã®å…ˆã«ã¤ãã“ã¨", a: ["å—ç²‰", "å—ç²¾", "ç™ºèŠ½"], c: 0 },
    { cat: "ç†ç§‘", q: "é¡•å¾®é¡ã§è¦‹ã‚‹ã¨ãä½¿ã†æ¿", a: ["ãƒ—ãƒ¬ãƒ‘ãƒ©ãƒ¼ãƒˆ", "ã‚·ãƒ£ãƒ¼ãƒ¬", "ãƒ“ãƒ¼ã‚«ãƒ¼"], c: 0 },
    { cat: "ç†ç§‘", q: "æµã‚Œã‚‹æ°´ã®åƒãã€Œæµ¸é£Ÿã€ã¨ï¼Ÿ", a: ["é‹æ¬ãƒ»å †ç©", "ç ´å£Šãƒ»å‰µé€ ", "è’¸ç™ºãƒ»å‡å›º"], c: 0 },
    { cat: "ç†ç§‘", q: "1æ—¥ã®æ°—æ¸©ãŒä¸€ç•ªé«˜ã„ã®ã¯ï¼Ÿ", a: ["14æ™‚ã”ã‚", "12æ™‚ã”ã‚", "10æ™‚ã”ã‚"], c: 0 },
    { cat: "ç†ç§‘", q: "é›¨ã®é‡ã‚’æ¸¬ã‚‹é“å…·", a: ["é›¨é‡è¨ˆ", "æ¸©åº¦è¨ˆ", "é¢¨å‘è¨ˆ"], c: 0 },
    { cat: "ç†ç§‘", q: "ãƒ˜ãƒãƒã®é›„èŠ±ã«ã‚ã‚‹ã®ã¯ï¼Ÿ", a: ["èŠ±ç²‰", "å®Ÿ", "ç¨®"], c: 0 },
    { cat: "ç†ç§‘", q: "é›»ç£çŸ³ã‚’å¼·ãã™ã‚‹ã«ã¯ï¼Ÿ", a: ["å·»ãæ•°ã‚’å¢—ã‚„ã™", "é›»æ± ã‚’æ¸›ã‚‰ã™", "ç´°ãã™ã‚‹"], c: 0 },
    { cat: "ç†ç§‘", q: "æ–¹ä½ç£é‡ã®NãŒæŒ‡ã™æ–¹è§’", a: ["åŒ—", "å—", "æ±"], c: 0 },
    { cat: "ç†ç§‘", q: "æº¶ã‘ãŸã‚‚ã®ãŒå†ã³å‡ºã¦ãã‚‹ã“ã¨", a: ["çµæ™¶", "è’¸ç™º", "èè§£"], c: 0 },
    { cat: "ç†ç§‘", q: "é­šãŒå‘¼å¸ã«ä½¿ã†éƒ¨åˆ†", a: ["ã‚¨ãƒ©", "è‚º", "å£"], c: 0 },
    { cat: "ç†ç§‘", q: "å¤©æ°—è¨˜å·ã€Œâ—ã€ã¯ï¼Ÿ", a: ["ãã‚‚ã‚Š", "æ™´ã‚Œ", "é›¨"], c: 0 },
    { cat: "ç†ç§‘", q: "ãƒ¢ãƒ¼ã‚¿ãƒ¼ãŒå›ã‚‹åŠ›", a: ["ç£åŠ›", "é‡åŠ›", "æ‘©æ“¦åŠ›"], c: 0 },
    { cat: "ç†ç§‘", q: "ç§‹ã®ä¸ƒè‰ã§ã¯ãªã„ã‚‚ã®", a: ["ã‚µã‚¯ãƒ©", "ãƒã‚®", "ã‚¹ã‚¹ã‚­"], c: 0 },
    { cat: "ç†ç§‘", q: "åŒ—æ¥µæ˜Ÿã‚’è¦‹ã¤ã‘ã‚‹æ˜Ÿåº§", a: ["ã‚«ã‚·ã‚ªãƒšãƒ¤åº§", "ã‚ªãƒªã‚ªãƒ³åº§", "ã•ãã‚Šåº§"], c: 0 },
    { cat: "ç†ç§‘", q: "æ—¥ãªãŸã¨æ—¥é™°ã€æ¸©ã‹ã„ã®ã¯ï¼Ÿ", a: ["æ—¥ãªãŸ", "æ—¥é™°", "åŒã˜"], c: 0 },
    { cat: "ç†ç§‘", q: "ãƒŸãƒ§ã‚¦ãƒãƒ³ã¯ãŠæ¹¯ã«ï¼Ÿ", a: ["ã‚ˆãæº¶ã‘ã‚‹", "æº¶ã‘ãªã„", "å¤‰ã‚ã‚‰ãªã„"], c: 0 },
    { cat: "ç†ç§‘", q: "å—ç²‰ã‚’æ‰‹ä¼ã†è™«", a: ["ãƒŸãƒ„ãƒãƒ", "ã‚«ãƒã‚­ãƒª", "ãƒ€ãƒ³ã‚´ãƒ ã‚·"], c: 0 },
    { cat: "ç†ç§‘", q: "å°é¢¨ã®ç›®ã®ä¸­ã®å¤©æ°—", a: ["æ™´ã‚Œã‚„é¢¨ãŒå¼±ã„", "å¤§åµ", "é›·"], c: 0 },
    { cat: "ç†ç§‘", q: "å·ã®ä¸Šæµã«ã‚ã‚‹çŸ³ã®å½¢", a: ["è§’ã°ã£ã¦ã„ã‚‹", "ä¸¸ã„", "ç ‚ã¿ãŸã„"], c: 0 },
    { cat: "ç†ç§‘", q: "äººã®ä½“æ¸©ã¯ãŠã‚ˆãï¼Ÿ", a: ["36åº¦", "30åº¦", "40åº¦"], c: 0 },

    // --- ç¤¾ä¼š (Social) ---
    { cat: "ç¤¾ä¼š", q: "æ—¥æœ¬ã®æœ€å—ç«¯ã®å³¶", a: ["æ²–ãƒé³¥å³¶", "ä¸é‚£å›½å³¶", "å—é³¥å³¶"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ—¥æœ¬ä¸€é«˜ã„å±±", a: ["å¯Œå£«å±±", "åŒ—å²³", "æ§ãƒ¶å²³"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "ç±³ä½œã‚ŠãŒç››ã‚“ãªå¹³é‡", a: ["åº„å†…å¹³é‡", "é–¢æ±å¹³é‡", "åå‹å¹³é‡"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "è‡ªå‹•è»Šå·¥æ¥­ãŒç››ã‚“ãªéƒ½å¸‚", a: ["è±Šç”°å¸‚", "äº¬éƒ½å¸‚", "æœ­å¹Œå¸‚"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ—¥æœ¬ã®å‘¨ã‚Šã®æµ·æµ(æš–æµ)", a: ["é»’æ½®", "è¦ªæ½®", "ãƒªãƒãƒ³æµ·æµ"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "å¯’ã„åœ°æ–¹ã®å®¶ä½œã‚Šã®å·¥å¤«", a: ["çª“ã‚’äºŒé‡ã«ã™ã‚‹", "åºŠã‚’é«˜ãã™ã‚‹", "çª“ã‚’å¤§ããã™ã‚‹"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ—¥æœ¬ã§ä¸€ç•ªåºƒã„æ¹–", a: ["çµç¶æ¹–", "éœãƒ¶æµ¦", "ã‚µãƒ­ãƒæ¹–"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "åœ°å›³è¨˜å·ã€Œâ›†ã€", a: ["æ¸©æ³‰", "äº¤ç•ª", "ç—…é™¢"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "åœ°å›³è¨˜å·ã€Œäº¤ç•ªã€ã®å½¢", a: ["Ã—ï¼ˆãƒãƒ„ï¼‰", "â—‹ï¼ˆãƒãƒ«ï¼‰", "â–¡ï¼ˆã‚·ã‚«ã‚¯ï¼‰"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "ä¿ƒæˆæ ½åŸ¹ã§ä½œã‚‹é‡èœ", a: ["ãƒ”ãƒ¼ãƒãƒ³ãƒ»ãƒŠã‚¹", "ãƒªãƒ³ã‚´", "ç™½èœ"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æŠ‘åˆ¶æ ½åŸ¹ãŒç››ã‚“ãªåœ°åŸŸ", a: ["é‡è¾ºå±±åŸ", "å®®å´å¹³é‡", "è¶Šå¾Œå¹³é‡"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ—¥æœ¬ã®ä¸»é£Ÿ", a: ["ç±³", "ãƒ‘ãƒ³", "éºº"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ°´ç”£æ¥­ãŒç››ã‚“ãªæµ·æµã®ã¶ã¤ã‹ã‚Š", a: ["æ½®ç›®", "æµ·æº", "å¤§é™¸æ£š"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "äº¬æµœå·¥æ¥­åœ°å¸¯ã®ä¸­å¿ƒ", a: ["æ±äº¬ãƒ»æ¨ªæµœ", "å¤§é˜ªãƒ»ç¥æˆ¸", "åå¤å±‹"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "ä¼çµ±çš„å·¥èŠ¸å“ã€Œå—éƒ¨é‰„å™¨ã€ã®çœŒ", a: ["å²©æ‰‹çœŒ", "é’æ£®çœŒ", "ç§‹ç”°çœŒ"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "å…¬å®³ç—…ã€Œæ°´ä¿£ç—…ã€ã®åŸå› ", a: ["ãƒ¡ãƒãƒ«æ°´éŠ€", "ã‚«ãƒ‰ãƒŸã‚¦ãƒ ", "äºŒé…¸åŒ–ç¡«é»„"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ£®æ—ã®åƒã", a: ["æ°´ã‚’è“„ãˆã‚‹", "ç©ºæ°—ã‚’æ±šã™", "åœŸã‚’æµã™"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æƒ…å ±ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ´»ç”¨", a: ["POSã‚·ã‚¹ãƒ†ãƒ ", "SOSã‚·ã‚¹ãƒ†ãƒ ", "PTAã‚·ã‚¹ãƒ†ãƒ "], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ–°èã‚’ä½œã‚‹ä»•äº‹", a: ["è¨˜è€…", "åŒ»è€…", "é‹è»¢æ‰‹"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "ä¸–ç•Œè‡ªç„¶éºç”£", a: ["å±‹ä¹…å³¶", "å§«è·¯åŸ", "åŸçˆ†ãƒ‰ãƒ¼ãƒ "], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ—¥æœ¬ä¸€é•·ã„å·", a: ["ä¿¡æ¿ƒå·", "åˆ©æ ¹å·", "çŸ³ç‹©å·"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "ãƒªã‚¢ã‚¹æµ·å²¸ãŒè¦‹ã‚‰ã‚Œã‚‹å ´æ‰€", a: ["ä¸‰é™¸æµ·å²¸", "ä¹åä¹é‡Œæµœ", "é³¥å–ç ‚ä¸˜"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ²–ç¸„çœŒã®æ°—å€™åŒºåˆ†", a: ["å—è¥¿è«¸å³¶ã®æ°—å€™", "æ—¥æœ¬æµ·å´ã®æ°—å€™", "ç€¬æˆ¸å†…ã®æ°—å€™"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "çŸ³æ²¹åŒ–å­¦ã‚³ãƒ³ãƒ“ãƒŠãƒ¼ãƒˆ", a: ["çŸ³æ²¹è£½å“ã‚’ä½œã‚‹", "é­šã‚’ç²ã‚‹", "é‡èœã‚’ä½œã‚‹"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ—¥æœ¬ã®é£Ÿæ–™è‡ªçµ¦ç‡ã¯ï¼Ÿ", a: ["ä½ã„(ç´„38%)", "é«˜ã„(ç´„80%)", "åŠåˆ†(50%)"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "è²¿æ˜“æ¸¯ã¨ã—ã¦æœ‰åãªå ´æ‰€", a: ["æ¨ªæµœæ¸¯", "æ¼æ¸¯", "ç©ºæ¸¯"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "ä¸­å°å·¥å ´ãŒå¤šã„éƒ½å¸‚", a: ["æ±å¤§é˜ªå¸‚", "è±Šç”°å¸‚", "åŒ—ä¹å·å¸‚"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ”¾é€å±€ã®å½¹å‰²", a: ["æƒ…å ±ã‚’ä¼ãˆã‚‹", "å•†å“ã‚’å£²ã‚‹", "æ³•å¾‹ã‚’ä½œã‚‹"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "è¼ªä¸­(ã‚ã˜ã‚…ã†)ãŒã‚ã‚‹å ´æ‰€", a: ["æ¿ƒå°¾å¹³é‡", "é–¢æ±å¹³é‡", "å¤§é˜ªå¹³é‡"], c: 0 },
    { cat: "ç¤¾ä¼š", q: "æ£šç”°(ãŸãªã )ã®ç›®çš„", a: ["æ–œé¢ã§ç±³ä½œã‚Š", "è¦³å…‰ã®ãŸã‚", "æ´ªæ°´ã‚’é˜²ã"], c: 0 },

    // --- è‹±èª (English) ---
    { cat: "è‹±èª", q: "Wednesday", a: ["æ°´æ›œæ—¥", "ç«æ›œæ—¥", "æœ¨æ›œæ—¥"], c: 0 },
    { cat: "è‹±èª", q: "Station", a: ["é§…", "å…¬åœ’", "å­¦æ ¡"], c: 0 },
    { cat: "è‹±èª", q: "Apple", a: ["ã‚Šã‚“ã”", "ãƒãƒŠãƒŠ", "ã‚ªãƒ¬ãƒ³ã‚¸"], c: 0 },
    { cat: "è‹±èª", q: "Twelve", a: ["12", "11", "20"], c: 0 },
    { cat: "è‹±èª", q: "Library", a: ["å›³æ›¸é¤¨", "æœ¬å±‹", "æ•™å®¤"], c: 0 },
    { cat: "è‹±èª", q: "Teacher", a: ["å…ˆç”Ÿ", "ç”Ÿå¾’", "åŒ»è€…"], c: 0 },
    { cat: "è‹±èª", q: "Breakfast", a: ["æœé£Ÿ", "æ˜¼é£Ÿ", "å¤•é£Ÿ"], c: 0 },
    { cat: "è‹±èª", q: "Summer", a: ["å¤", "æ˜¥", "å†¬"], c: 0 },
    { cat: "è‹±èª", q: "Red", a: ["èµ¤", "é’", "é»„"], c: 0 },
    { cat: "è‹±èª", q: "Dog", a: ["çŠ¬", "çŒ«", "é³¥"], c: 0 },
    { cat: "è‹±èª", q: "Soccer", a: ["ã‚µãƒƒã‚«ãƒ¼", "é‡çƒ", "ãƒ†ãƒ‹ã‚¹"], c: 0 },
    { cat: "è‹±èª", q: "Good morning", a: ["ãŠã¯ã‚ˆã†", "ã“ã‚“ã«ã¡ã¯", "ã•ã‚ˆã†ãªã‚‰"], c: 0 },
    { cat: "è‹±èª", q: "Thank you", a: ["ã‚ã‚ŠãŒã¨ã†", "ã”ã‚ã‚“ãªã•ã„", "ãŠé¡˜ã„ã—ã¾ã™"], c: 0 },
    { cat: "è‹±èª", q: "Book", a: ["æœ¬", "ãƒãƒ¼ãƒˆ", "é‰›ç­†"], c: 0 },
    { cat: "è‹±èª", q: "Chair", a: ["ã„ã™", "æœº", "ãƒ™ãƒƒãƒ‰"], c: 0 },
    { cat: "è‹±èª", q: "Mother", a: ["ãŠæ¯ã•ã‚“", "ãŠçˆ¶ã•ã‚“", "å¦¹"], c: 0 },
    { cat: "è‹±èª", q: "Friend", a: ["å‹é”", "å®¶æ—", "å…ˆç”Ÿ"], c: 0 },
    { cat: "è‹±èª", q: "Happy", a: ["å¹¸ã›", "æ‚²ã—ã„", "æ€’ã‚‹"], c: 0 },
    { cat: "è‹±èª", q: "Big", a: ["å¤§ãã„", "å°ã•ã„", "é•·ã„"], c: 0 },
    { cat: "è‹±èª", q: "Run", a: ["èµ°ã‚‹", "æ­©ã", "æ³³ã"], c: 0 },
    { cat: "è‹±èª", q: "Swim", a: ["æ³³ã", "æ­Œã†", "é£›ã¶"], c: 0 },
    { cat: "è‹±èª", q: "January", a: ["1æœˆ", "2æœˆ", "6æœˆ"], c: 0 },
    { cat: "è‹±èª", q: "August", a: ["8æœˆ", "4æœˆ", "10æœˆ"], c: 0 },
    { cat: "è‹±èª", q: "Music", a: ["éŸ³æ¥½", "ç®—æ•°", "ç†ç§‘"], c: 0 },
    { cat: "è‹±èª", q: "Japan", a: ["æ—¥æœ¬", "ã‚¢ãƒ¡ãƒªã‚«", "ä¸­å›½"], c: 0 },
    { cat: "è‹±èª", q: "English", a: ["è‹±èª", "å›½èª", "ç¤¾ä¼š"], c: 0 },
    { cat: "è‹±èª", q: "Elephant", a: ["ã‚¾ã‚¦", "ãƒ©ã‚¤ã‚ªãƒ³", "ã‚­ãƒªãƒ³"], c: 0 },
    { cat: "è‹±èª", q: "Fish", a: ["é­š", "è‚‰", "é‡èœ"], c: 0 },
    { cat: "è‹±èª", q: "Pen", a: ["ãƒšãƒ³", "æ¶ˆã—ã‚´ãƒ ", "å®šè¦"], c: 0 },
    { cat: "è‹±èª", q: "Yellow", a: ["é»„è‰²", "ç™½", "é»’"], c: 0 },

    // --- ãã®ä»– ---
    { cat: "éŸ³æ¥½", q: "ãƒ•ã‚©ãƒ«ãƒ†(f)ã®æ„å‘³", a: ["å¼·ã", "å¼±ã", "é€Ÿã"], c: 0 },
    { cat: "éŸ³æ¥½", q: "ãƒ”ã‚¢ãƒ(p)ã®æ„å‘³", a: ["å¼±ã", "å¼·ã", "é…ã"], c: 0 },
    { cat: "éŸ³æ¥½", q: "ãƒˆéŸ³è¨˜å·", a: ["é«˜éŸ³éƒ¨", "ä½éŸ³éƒ¨", "æ‰“æ¥½å™¨"], c: 0 },
    { cat: "éŸ³æ¥½", q: "ã‚¯ãƒ¬ã‚·ã‚§ãƒ³ãƒ‰ã®æ„å‘³", a: ["ã ã‚“ã ã‚“å¼·ã", "ã ã‚“ã ã‚“å¼±ã", "æ€¥ã«å¼·ã"], c: 0 },
    { cat: "éŸ³æ¥½", q: "å››åˆ†éŸ³ç¬¦ã®é•·ã•", a: ["1æ‹", "2æ‹", "0.5æ‹"], c: 0 },
    { cat: "éŸ³æ¥½", q: "ãƒªã‚³ãƒ¼ãƒ€ãƒ¼ã®ç©´ã®æ•°", a: ["8å€‹", "6å€‹", "10å€‹"], c: 0 },
    { cat: "éŸ³æ¥½", q: "ã€Œæ˜¥ã®å°å·ã€ã¯â€¦", a: ["ã•ã‚‰ã•ã‚‰è¡Œãã‚ˆ", "ã©ã‚ã©ã‚è¡Œãã‚ˆ", "ã–ã‚ã–ã‚è¡Œãã‚ˆ"], c: 0 },
    { cat: "éŸ³æ¥½", q: "ãƒ™ãƒ¼ãƒˆãƒ¼ãƒ™ãƒ³ã®é‹å‘½", a: ["ã‚¸ãƒ£ã‚¸ãƒ£ã‚¸ãƒ£ã‚¸ãƒ£ãƒ¼ãƒ³", "ã‚­ãƒ©ã‚­ãƒ©ãƒ’ã‚«ãƒ«", "ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½"], c: 0 },
    { cat: "éŸ³æ¥½", q: "æŒ‡æ®è€…ã¯ä½•ã‚’ã™ã‚‹ï¼Ÿ", a: ["ãƒ†ãƒ³ãƒã‚’æ±ºã‚ã‚‹", "æ­Œã†", "è¸Šã‚‹"], c: 0 },
    { cat: "éŸ³æ¥½", q: "éµç›¤ãƒãƒ¼ãƒ¢ãƒ‹ã‚«ã®åˆ¥å", a: ["ãƒ”ã‚¢ãƒ‹ã‚«", "ãƒ”ã‚¢ãƒ", "ã‚ªãƒ«ã‚¬ãƒ³"], c: 0 },
    { cat: "ä½“è‚²", q: "çŸ­è·é›¢èµ°ã®ã‚¹ã‚¿ãƒ¼ãƒˆ", a: ["ã‚¯ãƒ©ã‚¦ãƒãƒ³ã‚°", "ã‚¹ã‚¿ãƒ³ãƒ‡ã‚£ãƒ³ã‚°", "ãƒ•ãƒ©ã‚¤ãƒ³ã‚°"], c: 0 },
    { cat: "ä½“è‚²", q: "æ°´æ³³ã®æ¯ç¶™ã", a: ["ã‚¯ãƒ­ãƒ¼ãƒ«ã¯æ¨ª", "å¹³æ³³ãã¯æ¨ª", "èƒŒæ³³ãã¯ä¸‹"], c: 0 },
    { cat: "ä½“è‚²", q: "ãƒªãƒ¬ãƒ¼ã§ä½¿ã†æ£’", a: ["ãƒãƒˆãƒ³", "ãƒãƒ¼ãƒ«", "ã‚¹ãƒ†ã‚£ãƒƒã‚¯"], c: 0 },
    { cat: "ä½“è‚²", q: "ã‚µãƒƒã‚«ãƒ¼ã®æ‰‹ã®ä½¿ç”¨", a: ["ã‚­ãƒ¼ãƒ‘ãƒ¼ã ã‘", "å…¨å“¡OK", "èª°ã‚‚ãƒ€ãƒ¡"], c: 0 },
    { cat: "ä½“è‚²", q: "ãƒã‚¹ã‚±ã®ãƒ‰ãƒªãƒ–ãƒ«", a: ["ã¤ã‘ã‚‹", "ã‘ã‚Œã‚‹", "ãªã’ã‚‹"], c: 0 },
    { cat: "ä½“è‚²", q: "è·³ã³ç®±ã®ç€åœ°", a: ["ãƒ”ã‚¿ãƒƒã¨æ­¢ã¾ã‚‹", "èµ°ã‚ŠæŠœã‘ã‚‹", "è»¢ãŒã‚‹"], c: 0 },
    { cat: "ä½“è‚²", q: "æº–å‚™é‹å‹•ã®ç›®çš„", a: ["æ€ªæˆ‘äºˆé˜²", "ç–²ã‚Œã‚‹ãŸã‚", "æ™‚é–“ã¤ã¶ã—"], c: 0 },
    { cat: "ä½“è‚²", q: "ãƒãƒ¼ãƒ‰ãƒ«èµ°", a: ["é£›ã³è¶Šãˆã‚‹", "ããã‚‹", "å€’ã™"], c: 0 },
    { cat: "ä½“è‚²", q: "ãƒãƒƒãƒˆé‹å‹•ã®å‰è»¢", a: ["é ­ã®å¾Œã‚ã‚’ã¤ã", "ãŠã§ã“ã‚’ã¤ã", "æ‰‹ã‚’ä½¿ã‚ãªã„"], c: 0 },
    { cat: "ä½“è‚²", q: "50mèµ°ã®å¹³å‡(å°5)", a: ["9ç§’ãã‚‰ã„", "5ç§’ãã‚‰ã„", "15ç§’ãã‚‰ã„"], c: 0 },
    { cat: "å®¶åº­", q: "ã”é£¯ã‚’ç‚Šãã¨ãã®æ°´", a: ["ãŠç±³ã®1.2å€", "ãŠç±³ã¨åŒã˜", "ãŠç±³ã®3å€"], c: 0 },
    { cat: "å®¶åº­", q: "åŒ…ä¸ã®æ¸¡ã—æ–¹", a: ["æŸ„ã‚’ç›¸æ‰‹ã«å‘ã‘ã‚‹", "åˆƒã‚’ç›¸æ‰‹ã«å‘ã‘ã‚‹", "æŠ•ã’ã‚‹"], c: 0 },
    { cat: "å®¶åº­", q: "å‘³å™Œæ±ã®å‡ºæ±(ã ã—)", a: ["ç…®å¹²ã—", "ç ‚ç³–", "å¡©"], c: 0 },
    { cat: "å®¶åº­", q: "ãƒœã‚¿ãƒ³ä»˜ã‘ã«ä½¿ã†ã‚‚ã®", a: ["é‡ã¨ç³¸", "ãƒœãƒ³ãƒ‰", "ãƒ†ãƒ¼ãƒ—"], c: 0 },
    { cat: "å®¶åº­", q: "ã‚¢ã‚¤ãƒ­ãƒ³ã®æ³¨æ„ç‚¹", a: ["ã‚„ã‘ã©", "æ°´æ¼ã‚Œ", "é‡ã•"], c: 0 },
    { cat: "å®¶åº­", q: "äº”å¤§æ „é¤Šç´ ã€Œç‚­æ°´åŒ–ç‰©ã€", a: ["ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ãªã‚‹", "ä½“ã‚’ä½œã‚‹", "èª¿å­ã‚’æ•´ãˆã‚‹"], c: 0 },
    { cat: "å®¶åº­", q: "ã‚†ã§åµã®æ™‚é–“(å›ºã‚†ã§)", a: ["12åˆ†", "3åˆ†", "30åˆ†"], c: 0 },
    { cat: "å®¶åº­", q: "è³å‘³æœŸé™ã®æ„å‘³", a: ["ç¾å‘³ã—ãé£Ÿã¹ã‚‰ã‚Œã‚‹", "éããŸã‚‰æ¯’", "ä½œã£ãŸæ—¥"], c: 0 },
    { cat: "å®¶åº­", q: "æƒé™¤ã®åŸºæœ¬", a: ["ä¸Šã‹ã‚‰ä¸‹ã¸", "ä¸‹ã‹ã‚‰ä¸Šã¸", "é©å½“ã«"], c: 0 },
    { cat: "å®¶åº­", q: "æ•´ç†æ•´é “ã®ã€Œæ•´é “ã€", a: ["ä½¿ã„ã‚„ã™ãä¸¦ã¹ã‚‹", "æ¨ã¦ã‚‹", "éš ã™"], c: 0 }
];

// ========== ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ ==========

const MAX_HP = 100;
const DAMAGE_PLAYER = 20;
const DAMAGE_ENEMY_BASE = 25;
const LEVEL_UP_INTERVAL = 5;
const TIME_LIMIT = 15;
const BOSS_INTERVAL = 5; // 5ã‚¹ãƒ†ãƒ¼ã‚¸ã”ã¨ã«ãƒœã‚¹
const MAX_STAGE = 10; // å…¨10ã‚¹ãƒ†ãƒ¼ã‚¸

const ENEMIES = [
    { icon: "ğŸ‘¾", name: "ãƒã‚°ã‚¹ãƒ©ã‚¤ãƒ " },
    { icon: "ğŸ¦‡", name: "ã‚·ãƒ£ãƒ‰ãƒ¼ãƒãƒƒãƒˆ" },
    { icon: "ğŸ¦‚", name: "ãƒ‡ã‚¶ãƒ¼ãƒˆã‚µã‚½ãƒª" },
    { icon: "ğŸ‘»", name: "ã‚´ãƒ¼ã‚¹ãƒˆ" },
    { icon: "ğŸº", name: "ã‚¦ãƒ«ãƒ•" },
    { icon: "ğŸ‘¹", name: "ã‚¢ã‚«ã‚ªãƒ‹" },
    { icon: "ğŸ¤–", name: "ãƒ­ãƒœå…µå£«" },
    { icon: "ğŸ¦–", name: "T-ãƒ¬ãƒƒã‚¯ã‚¹" },
    { icon: "ğŸ‘º", name: "ãƒ†ãƒ³ã‚°" },
    { icon: "ğŸ‘½", name: "ã‚¨ã‚¤ãƒªã‚¢ãƒ³" }
];
const BOSSES = [
    { icon: "ğŸ‰", name: "ãƒ‰ãƒ©ã‚´ãƒ³" },
    { icon: "ğŸ¦‘", name: "ã‚¯ãƒ©ãƒ¼ã‚±ãƒ³" },
    { icon: "ğŸ‘¿", name: "é­”ç‹" }
];

let gameState = {
    hp: MAX_HP,
    level: 1,
    stage: 1,
    score: 0,
    combo: 0,
    maxCombo: 0,
    enemyHp: 100,
    currentQ: null,
    timer: null,
    timeLeft: TIME_LIMIT,
    isBoss: false,
    shuffledDB: []
};

let savedLevel = localStorage.getItem('quizHeroLevel');
if(savedLevel) {
    document.getElementById('high-score-level').innerText = savedLevel;
}

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function startGame() {
    // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§BGMé–‹å§‹ï¼ˆiOSå¯¾ç­–ï¼‰
    bgm.currentTime = 0;
    bgm.play().catch(e => console.log("Audio play failed:", e));

    document.getElementById('start-screen').classList.add('hidden');
    document.getElementById('result-screen').classList.add('hidden');
    document.getElementById('ending-screen').classList.add('hidden');
    
    gameState.hp = MAX_HP;
    gameState.level = 1;
    gameState.stage = 1;
    gameState.score = 0;
    gameState.combo = 0;
    gameState.maxCombo = 0;
    gameState.shuffledDB = shuffleArray([...QUIZ_DB]);
    
    updateHUD();
    spawnEnemy();
    nextQuestion();
}

function spawnEnemy() {
    gameState.isBoss = (gameState.stage % BOSS_INTERVAL === 0);
    
    // ä¿®æ­£ï¼šãƒœã‚¹ã®HPã‚’2å€ã«è¨­å®š (Plan A)
    if (gameState.isBoss) {
        gameState.enemyHp = 200;
    } else {
        gameState.enemyHp = 100;
    }
    
    const enemyContainer = document.getElementById('enemy-container');
    const sprite = document.getElementById('enemy-sprite');
    const name = document.getElementById('enemy-name');

    sprite.style.transform = "scale(0)";
    
    let enemyData;
    if (gameState.isBoss) {
        // ãƒ©ã‚¹ãƒˆã‚¹ãƒ†ãƒ¼ã‚¸ã¯é­”ç‹å›ºå®š
        if(gameState.stage === MAX_STAGE) {
             enemyData = BOSSES[2];
        } else {
             enemyData = BOSSES[Math.floor(Math.random() * BOSSES.length)];
        }
        sprite.className = "boss-sprite animate-bounce";
    } else {
        enemyData = ENEMIES[Math.floor(Math.random() * ENEMIES.length)];
        sprite.className = "character-sprite";
    }

    setTimeout(() => {
        sprite.innerText = enemyData.icon;
        name.innerText = gameState.isBoss ? "BOSS: " + enemyData.name : "Lv." + gameState.stage + " " + enemyData.name;
        sprite.style.transform = "scale(1)";
        document.getElementById('enemy-hp').style.width = '100%';
    }, 100);
}

function nextQuestion() {
    if (gameState.shuffledDB.length === 0) {
        gameState.shuffledDB = shuffleArray([...QUIZ_DB]);
    }
    gameState.currentQ = gameState.shuffledDB.pop();
    renderQuestion();
    startTimer();
}

function startTimer() {
    clearInterval(gameState.timer);
    gameState.timeLeft = TIME_LIMIT;
    const timerBar = document.getElementById('timer-bar');
    
    gameState.timer = setInterval(() => {
        gameState.timeLeft -= 0.1;
        const percent = (gameState.timeLeft / TIME_LIMIT) * 100;
        timerBar.style.width = percent + "%";

        if (gameState.timeLeft <= 0) {
            clearInterval(gameState.timer);
            timeUp();
        }
    }, 100);
}

function timeUp() {
    takeDamage(10);
    showMessage("æ™‚é–“åˆ‡ã‚Œï¼", "text-yellow-400");
    resetCombo();
    setTimeout(nextQuestion, 1000);
}

function renderQuestion() {
    const q = gameState.currentQ;
    const catColors = { "ç®—æ•°": "bg-blue-600", "å›½èª": "bg-red-600", "ç†ç§‘": "bg-green-600", "ç¤¾ä¼š": "bg-yellow-600", "è‹±èª": "bg-purple-600", "éŸ³æ¥½": "bg-pink-500", "ä½“è‚²": "bg-orange-500", "å®¶åº­": "bg-teal-500" };
    
    document.getElementById('q-category').innerText = q.cat;
    document.getElementById('q-category').className = `inline-block text-xs px-2 py-1 rounded text-white mb-1 ${catColors[q.cat] || "bg-gray-600"}`;
    document.getElementById('q-text').innerText = q.q;

    const optionsContainer = document.getElementById('options-container');
    optionsContainer.innerHTML = "";

    let options = q.a.map((ans, index) => ({ text: ans, originalIndex: index }));
    options = shuffleArray(options);

    options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = "btn-answer w-full py-3 px-4 text-lg font-bold text-white relative overflow-hidden";
        btn.innerText = opt.text;
        btn.onclick = () => checkAnswer(opt.originalIndex, btn);
        optionsContainer.appendChild(btn);
    });
}

function checkAnswer(index, btnElement) {
    clearInterval(gameState.timer);
    
    const btns = document.querySelectorAll('.btn-answer');
    btns.forEach(b => b.disabled = true);

    const isCorrect = (index === 0);

    if (isCorrect) {
        btnElement.classList.add('btn-correct');
        attackEnemy();
        gameState.score++;
        gameState.combo++;
        if (gameState.combo > gameState.maxCombo) gameState.maxCombo = gameState.combo;
        
        if (gameState.combo > 1) {
            document.getElementById('combo-display').classList.remove('hidden');
            document.getElementById('combo-count').innerText = gameState.combo;
        }

        let damage = DAMAGE_ENEMY_BASE;
        if (gameState.combo >= 3) damage *= 1.5;
        if (gameState.combo >= 5) damage *= 2.0;

        gameState.enemyHp -= damage;
        if (gameState.enemyHp < 0) gameState.enemyHp = 0;
        
        // ä¿®æ­£: ãƒœã‚¹ã®å ´åˆã¯æœ€å¤§HPãŒé•ã†ã®ã§å‰²åˆè¨ˆç®—ã‚’å¤‰ãˆã‚‹
        const currentMaxHp = gameState.isBoss ? 200 : 100;
        document.getElementById('enemy-hp').style.width = (gameState.enemyHp / currentMaxHp * 100) + '%';

        if (gameState.enemyHp <= 0) {
            setTimeout(() => {
                enemyDefeated();
            }, 500);
        } else {
            setTimeout(nextQuestion, 800);
        }

    } else {
        btnElement.classList.add('btn-wrong');
        btns.forEach(b => {
             if (b.innerText === gameState.currentQ.a[0]) {
                 b.classList.add('btn-correct');
             }
        });
        
        takeDamage(DAMAGE_PLAYER);
        resetCombo();
        setTimeout(nextQuestion, 1500);
    }
}

function enemyDefeated() {
    showMessage("æ’ƒç ´ï¼", "text-yellow-300");
    
    // ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°åˆ¤å®š (10ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢)
    if (gameState.stage >= MAX_STAGE) {
        setTimeout(gameClear, 1500);
        return;
    }

    gameState.stage++;
    if (gameState.stage % LEVEL_UP_INTERVAL === 1 && gameState.stage > 1) {
        levelUp();
    } else {
        spawnEnemy();
        nextQuestion();
    }
    updateHUD();
}

function gameClear() {
    clearInterval(gameState.timer);
    bgm.pause(); // BGMåœæ­¢

    const currentHigh = localStorage.getItem('quizHeroLevel') || 0;
    if (gameState.level > currentHigh) {
        localStorage.setItem('quizHeroLevel', gameState.level);
    }

    document.getElementById('final-score').innerText = gameState.score * 100 + (gameState.maxCombo * 50);
    document.getElementById('ending-screen').classList.remove('hidden');
}

function levelUp() {
    gameState.level++;
    gameState.hp = MAX_HP;
    
    const flash = document.getElementById('flash-overlay');
    flash.style.opacity = 0.8;
    setTimeout(() => flash.style.opacity = 0, 300);

    showMessage("LEVEL UP!", "text-cyan-300", 2000);
    updateHUD();
    
    setTimeout(() => {
        spawnEnemy();
        nextQuestion();
    }, 1500);
}

function takeDamage(amount) {
    gameState.hp -= amount;
    if (gameState.hp < 0) gameState.hp = 0;
    
    document.querySelector('.game-container').classList.add('shake-anim');
    setTimeout(() => document.querySelector('.game-container').classList.remove('shake-anim'), 500);

    const overlay = document.getElementById('damage-overlay');
    overlay.style.opacity = 0.5;
    setTimeout(() => overlay.style.opacity = 0, 300);

    showDamageNumber(amount);
    updateHUD();

    if (gameState.hp <= 0) {
        setTimeout(gameOver, 500);
    }
}

function attackEnemy() {
    const sprite = document.getElementById('enemy-sprite');
    sprite.classList.add('attack-anim');
    setTimeout(() => sprite.classList.remove('attack-anim'), 200);
}

function updateHUD() {
    document.getElementById('player-hp').style.width = (gameState.hp / MAX_HP * 100) + '%';
    document.getElementById('hp-text').innerText = Math.ceil(gameState.hp);
    document.getElementById('level-display').innerText = gameState.level;
    document.getElementById('stage-display').innerText = gameState.stage;

    const hpBar = document.getElementById('player-hp');
    if (gameState.hp < 30) {
        hpBar.classList.remove('bg-green-500');
        hpBar.classList.add('bg-red-600', 'animate-pulse');
    } else {
        hpBar.classList.add('bg-green-500');
        hpBar.classList.remove('bg-red-600', 'animate-pulse');
    }
}

function resetCombo() {
    gameState.combo = 0;
    document.getElementById('combo-display').classList.add('hidden');
}

function showDamageNumber(num) {
    const el = document.createElement('div');
    el.className = 'damage-number';
    el.innerText = "-" + num;
    el.style.left = '20%';
    el.style.top = '50%';
    document.querySelector('.game-container').appendChild(el);
    setTimeout(() => el.remove(), 1000);
}

function showMessage(text, colorClass, duration = 1000) {
    const el = document.createElement('div');
    el.className = `absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-6xl font-bold z-50 ${colorClass}`;
    el.style.textShadow = "0 0 10px black";
    el.style.animation = "popIn 0.3s forwards";
    el.innerText = text;
    document.querySelector('.game-container').appendChild(el);
    setTimeout(() => el.remove(), duration);
}

function gameOver() {
    clearInterval(gameState.timer);
    bgm.pause(); // BGMåœæ­¢
    bgm.currentTime = 0;

    const currentHigh = localStorage.getItem('quizHeroLevel') || 0;
    if (gameState.level > currentHigh) {
        localStorage.setItem('quizHeroLevel', gameState.level);
        document.getElementById('result-title').innerText = "NEW RECORD!";
        document.getElementById('result-title').className = "text-5xl text-yellow-400 mb-4 font-bold animate-pulse";
    } else {
        document.getElementById('result-title').innerText = "GAME OVER";
        document.getElementById('result-title').className = "text-5xl text-red-500 mb-4 font-bold";
    }

    document.getElementById('result-level').innerText = gameState.level;
    document.getElementById('result-score').innerText = gameState.stage - 1;
    document.getElementById('result-combo').innerText = gameState.maxCombo;
    
    document.getElementById('result-screen').classList.remove('hidden');
}
</script>
</body>
</html>
